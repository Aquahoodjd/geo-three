<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>geo-three</title><meta name="description" content="Documentation for geo-three"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">geo-three</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>geo-three</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#geo-three" id="geo-three" style="color: inherit; text-decoration: none;">
  <h1>Geo-Three</h1>
</a>
<p><a href="https://badge.fury.io/js/geo-three"><img src="https://badge.fury.io/js/geo-three.svg" alt="npm version"></a><a href="https://badge.fury.io/gh/tentone%2Fgeo-three"><img src="https://badge.fury.io/gh/tentone%2Fgeo-three.svg" alt="GitHub version"></a>
<a href="https://app.fossa.com/projects/git%2Bgithub.com%2Ftentone%2Fgeo-three?ref=badge_shield"><img src="https://app.fossa.com/api/projects/git%2Bgithub.com%2Ftentone%2Fgeo-three.svg?type=shield" alt="FOSSA Status"></a></p>
<ul>
<li>Library to display maps using <code>three.js</code>. Allows for full world scale visualization of geographic data using tile based chunks.</li>
<li>Can generate 3D geometry for terrain from terrain height data using software generated tiles or using GPU displacement maps.</li>
<li>Supports multiple maps service providers (<a href="https://www.microsoft.com/en-us/maps">BingMaps</a>, <a href="https://developers.google.com/maps/documentation">GoogleMaps</a>, <a href="https://developer.here.com/">HereMaps</a>, <a href="https://docs.mapbox.com/api/">MapBox</a>, <a href="https://www.maptiler.com/">MapTiler</a>, <a href="https://openmaptiles.org/">OpenMapTiles</a>, <a href="https://www.openstreetmap.org/">OpenStreetMaps</a>).<ul>
<li>Each one of these map providers require a developer account and a API configuration to be used.</li>
<li>Its possible to implement new provides using the <code>MapProvider</code> interface.</li>
<li>Providers should have a tile based map system to be supported by the library.</li>
</ul>
</li>
<li>You can test the <a href="https://tentone.github.io/geo-three/">live demo of the library running</a> from the GitHub page.</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/screenshot/b.png" width="380"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/screenshot/c.png" width="380"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/screenshot/e.png" width="380"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/screenshot/d.png" width="380"></p>

<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h3>Usage</h3>
</a>
<ul>
<li>To add the library to your project get the library trough NPM alongside with three.js and use it as a ES module.</li>
<li>You can also include the library directly in you webpage but ensure first that THREE is available globally.</li>
</ul>
<pre><code class="language-javascript"><span class="hl-0">// Create a map tiles provider object</span><br/><span class="hl-1">var</span><span class="hl-2"> </span><span class="hl-3">provider</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">OpenStreetMapsProvider</span><span class="hl-2">();</span><br/><br/><span class="hl-0">// Create the map view and add it to your THREE scene</span><br/><span class="hl-1">var</span><span class="hl-2"> </span><span class="hl-3">map</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">MapView</span><span class="hl-2">(</span><span class="hl-3">MapView</span><span class="hl-2">.</span><span class="hl-5">PLANAR</span><span class="hl-2">, </span><span class="hl-3">provider</span><span class="hl-2">);</span><br/><span class="hl-3">scene</span><span class="hl-2">.</span><span class="hl-4">add</span><span class="hl-2">(</span><span class="hl-3">map</span><span class="hl-2">);</span>
</code></pre>

<a href="#coordinates" id="coordinates" style="color: inherit; text-decoration: none;">
  <h3>Coordinates</h3>
</a>
<ul>
<li>The project uses internally a XY <a href="https://epsg.io/900913">EPSG:900913</a> coordinate format to be compatible with the XYZ coordinates used in three.js</li>
<li>Use the <code>UnitsUtils</code> class to access the unit conversion methods for example to convert a latitude, longitude <a href="https://epsg.io/4326">WGS84</a> pair value to XY coordinates you can use the code bellow:</li>
</ul>
<pre><code class="language-javascript"><span class="hl-1">var</span><span class="hl-2"> </span><span class="hl-3">coords</span><span class="hl-2"> = </span><span class="hl-3">Geo</span><span class="hl-2">.</span><span class="hl-3">UnitsUtils</span><span class="hl-2">.</span><span class="hl-4">datumsToSpherical</span><span class="hl-2">(</span><span class="hl-6">40.940119</span><span class="hl-2">, -</span><span class="hl-6">8.535589</span><span class="hl-2">);</span><br/><span class="hl-3">controls</span><span class="hl-2">.</span><span class="hl-3">target</span><span class="hl-2">.</span><span class="hl-4">set</span><span class="hl-2">(</span><span class="hl-3">coords</span><span class="hl-2">.</span><span class="hl-3">x</span><span class="hl-2">, </span><span class="hl-6">0</span><span class="hl-2">, -</span><span class="hl-3">coords</span><span class="hl-2">.</span><span class="hl-3">y</span><span class="hl-2">);</span>
</code></pre>

<a href="#tile-loading" id="tile-loading" style="color: inherit; text-decoration: none;">
  <h3>Tile Loading</h3>
</a>
<ul>
<li><p>Tiles are fetched from the service API configured, each one of the services requires specific configuration using the specific <code>MapProvider</code> object.</p>
</li>
<li><p>Base tiles are always loaded at the beginning of the process, then each frame a couple of rays are casted into the tile tree. The number of rays can be configured using the <code>MapView</code> <code>subdivisionRays</code> attribute.</p>
</li>
<li><p>The distance of the ray to the camera is used to define if the node needs to simplified or sub-divided. These values can be configured using the <code>thresholdUp</code> and <code>thresholdDown</code> values.</p>
<p>â€‹</p>
</li>
</ul>
<img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/tiles.png" width="350">




<a href="#data-providers" id="data-providers" style="color: inherit; text-decoration: none;">
  <h3>Data Providers</h3>
</a>
<ul>
<li><p>The library has support for multiple data providers that must be configured beforehand. Most of these data providers rely on external API that differ from service to service.</p>
</li>
<li><p>Each one of them has its own provider object implementation of the <code>MapProvider</code> interface.</p>
</li>
<li><p>The <code>DebugProvider</code> provides information about the tiles loaded, shows the zoom level and the coordinates of the tile relative to the origin in that specific level.</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/bing_sat.png" width="270"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/heremaps_sat.png" width="270"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/mapbox_sat.png" width="270"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/bing_vector.png" width="270"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/heremaps_vector.png" width="270"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/mapbox_vector.png" width="270"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/osm_vector.png" width="270"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/debug.png" width="270"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/providers/mapbox_height.png" width="270"></p>

<a href="#lod-control" id="lod-control" style="color: inherit; text-decoration: none;">
  <h3>LOD Control</h3>
</a>
<ul>
<li>The library includes multiple methods for LOD control, that define how tiles are subdivided or simplified.<ul>
<li>Raycast: uses ray casting determine the distance of the nodes to the camera view, it only considers the nodes inside of the view frustum. It uses random sampling and takes some time to pick all nodes to be subdivided but is overall faster.</li>
<li>Radial: Calculates the distance from the camera to each one of the nodes, the nodes closer are subdivided and nodes far away are simplified a simple and effective method that considers all nodes, and provides a more consistent result.</li>
<li>Frustum: Similar to the radial mode but only nodes inside of the view frustum are considered for subdivision.</li>
</ul>
</li>
<li>Custom <code>LODControl</code> can be implemented by extending the <code>LODControl</code> object and implementing the <code>updateLOD(view, camera, renderer, scene)</code> method.</li>
</ul>
<pre><code class="language-javascript"><span class="hl-7">export</span><span class="hl-2"> </span><span class="hl-1">class</span><span class="hl-2"> </span><span class="hl-8">DistanceLOD</span><span class="hl-2"> </span><span class="hl-1">extends</span><span class="hl-2"> </span><span class="hl-8">LODControl</span><br/><span class="hl-2">{</span><br/><span class="hl-2">    </span><span class="hl-1">constructor</span><span class="hl-2">() {</span><span class="hl-1">super</span><span class="hl-2">();}</span><br/><br/><span class="hl-2">    </span><span class="hl-4">updateLOD</span><span class="hl-2">(</span><span class="hl-3">view</span><span class="hl-2">, </span><span class="hl-3">camera</span><span class="hl-2">, </span><span class="hl-3">renderer</span><span class="hl-2">, </span><span class="hl-3">scene</span><span class="hl-2">)</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">        </span><span class="hl-0">// Get world position of the camera.</span><br/><span class="hl-2">        </span><span class="hl-1">var</span><span class="hl-2"> </span><span class="hl-3">pov</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">Vector3</span><span class="hl-2">();</span><br/><span class="hl-2">        </span><span class="hl-3">camera</span><span class="hl-2">.</span><span class="hl-4">getWorldPosition</span><span class="hl-2">(</span><span class="hl-3">pov</span><span class="hl-2">);</span><br/><br/><span class="hl-2">        </span><span class="hl-3">view</span><span class="hl-2">.</span><span class="hl-4">traverse</span><span class="hl-2">(</span><span class="hl-1">function</span><span class="hl-2">(</span><span class="hl-3">node</span><span class="hl-2">)</span><br/><span class="hl-2">        {</span><br/><span class="hl-2">            </span><span class="hl-0">// Check if child in a MapNode</span><br/><span class="hl-2">            </span><span class="hl-7">if</span><span class="hl-2">(</span><span class="hl-3">node</span><span class="hl-2"> </span><span class="hl-1">instanceof</span><span class="hl-2"> </span><span class="hl-8">MapNode</span><span class="hl-2">)</span><br/><span class="hl-2">            {</span><br/><span class="hl-2">                </span><span class="hl-1">var</span><span class="hl-2"> </span><span class="hl-3">position</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">Vector3</span><span class="hl-2">();</span><br/><span class="hl-2">                </span><span class="hl-3">node</span><span class="hl-2">.</span><span class="hl-4">getWorldPosition</span><span class="hl-2">(</span><span class="hl-3">position</span><span class="hl-2">);</span><br/><span class="hl-2">                </span><br/><span class="hl-2">                </span><span class="hl-0">// Distance between camera and tile</span><br/><span class="hl-2">                </span><span class="hl-1">var</span><span class="hl-2"> </span><span class="hl-3">distance</span><span class="hl-2"> = </span><span class="hl-3">pov</span><span class="hl-2">.</span><span class="hl-4">distanceTo</span><span class="hl-2">(</span><span class="hl-3">position</span><span class="hl-2">);</span><br/><span class="hl-2">                </span><br/><span class="hl-2">                </span><span class="hl-0">// Normalize distance based on tile level</span><br/><span class="hl-2">                </span><span class="hl-3">distance</span><span class="hl-2"> /= </span><span class="hl-8">Math</span><span class="hl-2">.</span><span class="hl-4">pow</span><span class="hl-2">(</span><span class="hl-6">2</span><span class="hl-2">, </span><span class="hl-6">20</span><span class="hl-2"> - </span><span class="hl-3">node</span><span class="hl-2">.</span><span class="hl-3">level</span><span class="hl-2">);</span><br/><span class="hl-2">                </span><br/><span class="hl-2">                </span><span class="hl-0">// If closer than X subdivide</span><br/><span class="hl-2">                </span><span class="hl-7">if</span><span class="hl-2"> (</span><span class="hl-3">distance</span><span class="hl-2"> &lt; </span><span class="hl-6">50</span><span class="hl-2">)</span><br/><span class="hl-2">                {</span><br/><span class="hl-2">                    </span><span class="hl-3">node</span><span class="hl-2">.</span><span class="hl-4">subdivide</span><span class="hl-2">();</span><br/><span class="hl-2">                }</span><br/><span class="hl-2">                </span><span class="hl-0">// If far away, simplify parent</span><br/><span class="hl-2">                </span><span class="hl-7">else</span><span class="hl-2"> </span><span class="hl-7">if</span><span class="hl-2"> (</span><span class="hl-3">distance</span><span class="hl-2"> &gt; </span><span class="hl-6">200</span><span class="hl-2"> </span><span class="hl-3">node</span><span class="hl-2">.</span><span class="hl-3">parentNode</span><span class="hl-2">)</span><br/><span class="hl-2">                {</span><br/><span class="hl-2">                    </span><span class="hl-3">node</span><span class="hl-2">.</span><span class="hl-3">parentNode</span><span class="hl-2">.</span><span class="hl-4">simplify</span><span class="hl-2">();</span><br/><span class="hl-2">                }</span><br/><span class="hl-2">            }</span><br/><span class="hl-2">        });</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">}</span>
</code></pre>

<a href="#tiles-map-nodes" id="tiles-map-nodes" style="color: inherit; text-decoration: none;">
  <h3>Tiles Map Nodes</h3>
</a>
<ul>
<li><code>MapNode</code> objects are used to define how the tiles should be represented in the space. <code>MapNode</code> are organized hierarchically, every node implements the MapNode class that is based on the THREE.Mesh class (every map node has a visual representation as a mesh).</li>
<li>The library has support for both planar and spherical representation of tiles. Most providers only have planar tiles available.<ul>
<li>It is required that the tiles for spherical mode are previously adjusted, since planar tiles get more stretched as closer you get to the poles.</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/planar.png" width="350"><img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/spherical.png" width="350"></p>
<ul>
<li>There are available formats for GPU shader generated geometry using height data directly from the providers. <ul>
<li>GPU generated geometry is more dense, more detailed and a lot faster. But the final geometry used is not accessible for ray casting, so interaction with these geometries is limited.</li>
</ul>
</li>
<li>On the left the geometry was generated in CPU and on the right the geometry was displaced directly in the vertex shader.</li>
</ul>
<img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/shader.jpg" width="600">




<a href="#custom-data-providers" id="custom-data-providers" style="color: inherit; text-decoration: none;">
  <h3>Custom Data Providers</h3>
</a>
<ul>
<li>It is possible to create new data providers to access data other tile sources. New data sources have to provide access to the rasterized tile as a compatible DOM element (e.g. <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement">Image</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement">Canvas</a>, ...)</li>
<li>Custom providers have to extend the base <code>MapProvider</code> class and implement the <code>fetchTile(zoom, x, y)</code> method that returns a <code>Promise</code> with access to the tile data.</li>
<li>Bellow is an implementation of a provider to access <a href="https://www.openstreetmap.org/">OpenStreetMaps</a> tile data using the <a href="https://wiki.openstreetmap.org/wiki/Tiles">Tile API</a> the provider simply loads the URL data into a image element.</li>
<li>These methods are called directly by nodes being loaded into the scene. These should be always asynchronous and should avoid any blocking actions.</li>
</ul>
<pre><code class="language-javascript"><span class="hl-7">export</span><span class="hl-2"> </span><span class="hl-1">class</span><span class="hl-2"> </span><span class="hl-8">OpenStreetMapsProvider</span><span class="hl-2"> </span><span class="hl-1">extends</span><span class="hl-2"> </span><span class="hl-8">MapProvider</span><br/><span class="hl-2">{</span><br/><span class="hl-2">    </span><span class="hl-1">constructor</span><span class="hl-2">(</span><span class="hl-3">address</span><span class="hl-2">) {</span><span class="hl-1">super</span><span class="hl-2">();}</span><br/><br/><span class="hl-2">    </span><span class="hl-4">fetchTile</span><span class="hl-2">(</span><span class="hl-3">zoom</span><span class="hl-2">, </span><span class="hl-3">x</span><span class="hl-2">, </span><span class="hl-3">y</span><span class="hl-2">)</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">        </span><span class="hl-7">return</span><span class="hl-2"> </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-8">Promise</span><span class="hl-2">((</span><span class="hl-3">resolve</span><span class="hl-2">, </span><span class="hl-3">reject</span><span class="hl-2">) </span><span class="hl-1">=&gt;</span><br/><span class="hl-2">        {</span><br/><span class="hl-2">            </span><span class="hl-1">var</span><span class="hl-2"> </span><span class="hl-3">image</span><span class="hl-2"> = </span><span class="hl-3">document</span><span class="hl-2">.</span><span class="hl-4">createElement</span><span class="hl-2">(</span><span class="hl-9">&quot;img&quot;</span><span class="hl-2">);</span><br/><span class="hl-2">            </span><span class="hl-3">image</span><span class="hl-2">.</span><span class="hl-4">onload</span><span class="hl-2"> = </span><span class="hl-1">function</span><span class="hl-2">(){</span><span class="hl-4">resolve</span><span class="hl-2">(</span><span class="hl-3">image</span><span class="hl-2">);};</span><br/><span class="hl-2">            </span><span class="hl-3">image</span><span class="hl-2">.</span><span class="hl-4">onerror</span><span class="hl-2"> = </span><span class="hl-1">function</span><span class="hl-2">(){</span><span class="hl-4">reject</span><span class="hl-2">();};</span><br/><span class="hl-2">            </span><span class="hl-3">image</span><span class="hl-2">.</span><span class="hl-3">crossOrigin</span><span class="hl-2"> = </span><span class="hl-9">&quot;Anonymous&quot;</span><span class="hl-2">;</span><br/><span class="hl-2">            </span><span class="hl-3">image</span><span class="hl-2">.</span><span class="hl-3">src</span><span class="hl-2"> = </span><span class="hl-9">&quot;https://a.tile.openstreetmap.org/&quot;</span><span class="hl-2"> + </span><span class="hl-3">zoom</span><span class="hl-2"> + </span><span class="hl-9">&quot;/&quot;</span><span class="hl-2"> + </span><span class="hl-3">x</span><span class="hl-2"> + </span><span class="hl-9">&quot;/&quot;</span><span class="hl-2"> + </span><span class="hl-3">y</span><span class="hl-2"> + </span><span class="hl-9">&quot;.png&quot;</span><span class="hl-2">;</span><br/><span class="hl-2">        });</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">}</span>
</code></pre>
<ul>
<li>Tiles coordinates for each zoom level are counted from the left-top corner sequentially across the tiles.</li>
<li>Different API&#39;s might use different methods to index these tiles (e.g. <a href="https://docs.microsoft.com/en-us/bingmaps/articles/bing-maps-tile-system">Bing maps</a> uses a different indexing method).<ul>
<li>These coordinates need to be adapted to ensure correct loading when using this library.</li>
</ul>
</li>
</ul>
<img src="https://raw.githubusercontent.com/tentone/geo-three/master/readme/coords.png" width="600">

<ul>
<li>It is also possible to create fictional tiles without any external API to generate tiles by writing data directly into a canvas or even using a local image database to draw the map.</li>
<li>The code bellow shows how to implement a tile provided that draws a gradient from blue to red based on the zoom level of the tile with 16x16 pixels. This example can be used as basis for other code based tile generators.</li>
</ul>
<pre><code class="language-javascript"><span class="hl-7">import</span><span class="hl-2"> {</span><span class="hl-3">Color</span><span class="hl-2">} </span><span class="hl-7">from</span><span class="hl-2"> </span><span class="hl-9">&quot;three&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-7">export</span><span class="hl-2"> </span><span class="hl-1">class</span><span class="hl-2"> </span><span class="hl-8">BlueToRedProvider</span><span class="hl-2"> </span><span class="hl-1">extends</span><span class="hl-2"> </span><span class="hl-8">MapProvider</span><br/><span class="hl-2">{</span><br/><span class="hl-2">    </span><span class="hl-4">fetchTile</span><span class="hl-2">(</span><span class="hl-3">zoom</span><span class="hl-2">, </span><span class="hl-3">x</span><span class="hl-2">, </span><span class="hl-3">y</span><span class="hl-2">)</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">        </span><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-5">canvas</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">OffscreenCanvas</span><span class="hl-2">(</span><span class="hl-6">16</span><span class="hl-2">, </span><span class="hl-6">16</span><span class="hl-2">);</span><br/><span class="hl-2">        </span><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-5">context</span><span class="hl-2"> = </span><span class="hl-3">canvas</span><span class="hl-2">.</span><span class="hl-4">getContext</span><span class="hl-2">(</span><span class="hl-9">&#39;2d&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">        </span><br/><span class="hl-2">        </span><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-5">blue</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">Color</span><span class="hl-2">(</span><span class="hl-6">0x0000FF</span><span class="hl-2">);</span><br/><span class="hl-2">        </span><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-5">red</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">Color</span><span class="hl-2">(</span><span class="hl-6">0xFF0000</span><span class="hl-2">);</span><br/><span class="hl-2">        </span><span class="hl-1">const</span><span class="hl-2"> </span><span class="hl-5">color</span><span class="hl-2"> = </span><span class="hl-3">blue</span><span class="hl-2">.</span><span class="hl-4">lerpHSL</span><span class="hl-2">(</span><span class="hl-3">red</span><span class="hl-2">, (</span><span class="hl-3">zoom</span><span class="hl-2"> - </span><span class="hl-1">this</span><span class="hl-2">.</span><span class="hl-3">minZoom</span><span class="hl-2">) / (</span><span class="hl-1">this</span><span class="hl-2">.</span><span class="hl-3">maxZoom</span><span class="hl-2"> - </span><span class="hl-1">this</span><span class="hl-2">.</span><span class="hl-3">minZoom</span><span class="hl-2">));</span><br/><span class="hl-2">        </span><br/><span class="hl-2">        </span><span class="hl-3">context</span><span class="hl-2">.</span><span class="hl-3">fillStyle</span><span class="hl-2"> = </span><span class="hl-3">color</span><span class="hl-2">.</span><span class="hl-4">getStyle</span><span class="hl-2">();</span><br/><span class="hl-2">        </span><span class="hl-3">context</span><span class="hl-2">.</span><span class="hl-4">fillRect</span><span class="hl-2">(</span><span class="hl-6">0</span><span class="hl-2">, </span><span class="hl-6">0</span><span class="hl-2">, </span><span class="hl-6">16</span><span class="hl-2">, </span><span class="hl-6">16</span><span class="hl-2">);</span><br/><span class="hl-2">        </span><span class="hl-7">return</span><span class="hl-2"> </span><span class="hl-8">Promise</span><span class="hl-2">.</span><span class="hl-4">resolve</span><span class="hl-2">(</span><span class="hl-3">canvas</span><span class="hl-2">);</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">}</span>
</code></pre>

<a href="#custom-map-nodes" id="custom-map-nodes" style="color: inherit; text-decoration: none;">
  <h3>Custom Map Nodes</h3>
</a>
<ul>
<li>To implement a custom <code>MapNode</code> we can create a new class that extends the base implementation.</li>
<li>The objects created from the class should then be passed as argument to the <code>MapView</code> object that is responsible for managing its life cycle.</li>
<li>All map nodes are based on three.js <code>Mesh</code> object and have attached a Geometry and Material used to render them into the scene.</li>
<li>These materials and geometries can be customized and are not required to be of any specific type. It is recommended to reuse them as much as possible to save memory.</li>
</ul>
<pre><code class="language-javascript"><span class="hl-7">import</span><span class="hl-2"> {</span><span class="hl-3">SphereGeometry</span><span class="hl-2">, </span><span class="hl-3">MeshBasicMaterial</span><span class="hl-2">, </span><span class="hl-3">Vector3</span><span class="hl-2">} </span><span class="hl-7">from</span><span class="hl-2"> </span><span class="hl-9">&quot;three&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// The MapNode inherits from three Mesh object and requires a geometry and material</span><br/><span class="hl-7">export</span><span class="hl-2"> </span><span class="hl-1">class</span><span class="hl-2"> </span><span class="hl-8">CustomMapNode</span><span class="hl-2"> </span><span class="hl-1">extends</span><span class="hl-2"> </span><span class="hl-8">MapNode</span><br/><span class="hl-2">{</span><br/><span class="hl-2">    </span><span class="hl-1">constructor</span><span class="hl-2">(</span><span class="hl-3">parentNode</span><span class="hl-2"> = </span><span class="hl-1">null</span><span class="hl-2">, </span><span class="hl-3">mapView</span><span class="hl-2"> = </span><span class="hl-1">null</span><span class="hl-2">, </span><span class="hl-3">location</span><span class="hl-2"> = </span><span class="hl-3">MapNode</span><span class="hl-2">.</span><span class="hl-5">ROOT</span><span class="hl-2">, </span><span class="hl-3">level</span><span class="hl-2"> = </span><span class="hl-6">0</span><span class="hl-2">, </span><span class="hl-3">x</span><span class="hl-2"> = </span><span class="hl-6">0</span><span class="hl-2">, </span><span class="hl-3">y</span><span class="hl-2"> = </span><span class="hl-6">0</span><span class="hl-2">)</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">        </span><span class="hl-1">super</span><span class="hl-2">(</span><span class="hl-3">CustomMapNode</span><span class="hl-2">.</span><span class="hl-5">GEOMETRY</span><span class="hl-2">, </span><span class="hl-3">CustomMapNode</span><span class="hl-2">.</span><span class="hl-5">MATERIAL</span><span class="hl-2">, </span><span class="hl-3">parentNode</span><span class="hl-2">, </span><span class="hl-3">mapView</span><span class="hl-2">, </span><span class="hl-3">location</span><span class="hl-2">, </span><span class="hl-3">level</span><span class="hl-2">, </span><span class="hl-3">x</span><span class="hl-2">, </span><span class="hl-3">y</span><span class="hl-2">);</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">    </span><br/><span class="hl-2">    </span><span class="hl-1">static</span><span class="hl-2"> </span><span class="hl-3">GEOMETRY</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">SphereGeometry</span><span class="hl-2">(</span><span class="hl-6">0.5</span><span class="hl-2">, </span><span class="hl-6">32</span><span class="hl-2">, </span><span class="hl-6">32</span><span class="hl-2">); </span><br/><span class="hl-2">    </span><br/><span class="hl-2">    </span><span class="hl-1">static</span><span class="hl-2"> </span><span class="hl-3">MATERIAL</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">MeshBasicMaterial</span><span class="hl-2">();</span><br/><span class="hl-2">    </span><br/><span class="hl-2">    </span><span class="hl-0">// Base geometry applied to the map view.</span><br/><span class="hl-2">    </span><span class="hl-1">static</span><span class="hl-2"> </span><span class="hl-3">BASE_GEOMETRY</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">MapNodeGeometry</span><span class="hl-2">(</span><span class="hl-6">1</span><span class="hl-2">, </span><span class="hl-6">1</span><span class="hl-2">, </span><span class="hl-6">1</span><span class="hl-2">, </span><span class="hl-6">1</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><br/><span class="hl-2">    </span><span class="hl-0">// Base scale is applied to the map view</span><br/><span class="hl-2">    </span><span class="hl-1">static</span><span class="hl-2"> </span><span class="hl-3">BASE_SCALE</span><span class="hl-2"> = </span><span class="hl-1">new</span><span class="hl-2"> </span><span class="hl-4">Vector3</span><span class="hl-2">(</span><span class="hl-3">UnitsUtils</span><span class="hl-2">.</span><span class="hl-5">EARTH_PERIMETER</span><span class="hl-2">, </span><span class="hl-6">1</span><span class="hl-2">, </span><span class="hl-3">UnitsUtils</span><span class="hl-2">.</span><span class="hl-5">EARTH_PERIMETER</span><span class="hl-2">);</span><br/><br/><span class="hl-2">    </span><span class="hl-4">initialize</span><span class="hl-2">() {</span><br/><span class="hl-2">        </span><span class="hl-0">// Method to initialize data of the node (e.g fetch assets)</span><br/><span class="hl-2">    }</span><br/><br/><span class="hl-2">    </span><span class="hl-4">createChildNodes</span><span class="hl-2">()</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">        </span><span class="hl-0">// Method called on subdivision to craete child nodes</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">}</span>
</code></pre>

<a href="#license" id="license" style="color: inherit; text-decoration: none;">
  <h3>License</h3>
</a>
<ul>
<li>Project uses a MIT license that allow for commercial usage of the platform without any cost.</li>
<li>The license is available on the project GitHub page</li>
</ul>
<p><a href="https://app.fossa.com/projects/git%2Bgithub.com%2Ftentone%2Fgeo-three?ref=badge_large"><img src="https://app.fossa.com/api/projects/git%2Bgithub.com%2Ftentone%2Fgeo-three.svg?type=large" alt="FOSSA Status"></a></p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/BingMapsProvider.html" class="tsd-kind-icon">Bing<wbr/>Maps<wbr/>Provider</a></li><li class="tsd-kind-class tsd-has-type-parameter"><a href="classes/CancelablePromise.html" class="tsd-kind-icon">Cancelable<wbr/>Promise</a></li><li class="tsd-kind-class"><a href="classes/DebugProvider.html" class="tsd-kind-icon">Debug<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/GoogleMapsProvider.html" class="tsd-kind-icon">Google<wbr/>Maps<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/HeightDebugProvider.html" class="tsd-kind-icon">Height<wbr/>Debug<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/HereMapsProvider.html" class="tsd-kind-icon">Here<wbr/>Maps<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/LODFrustum.html" class="tsd-kind-icon">LODFrustum</a></li><li class="tsd-kind-class"><a href="classes/LODRadial.html" class="tsd-kind-icon">LODRadial</a></li><li class="tsd-kind-class"><a href="classes/LODRaycast.html" class="tsd-kind-icon">LODRaycast</a></li><li class="tsd-kind-class"><a href="classes/MapBoxProvider.html" class="tsd-kind-icon">Map<wbr/>Box<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/MapHeightNode.html" class="tsd-kind-icon">Map<wbr/>Height<wbr/>Node</a></li><li class="tsd-kind-class"><a href="classes/MapHeightNodeShader.html" class="tsd-kind-icon">Map<wbr/>Height<wbr/>Node<wbr/>Shader</a></li><li class="tsd-kind-class"><a href="classes/MapNode.html" class="tsd-kind-icon">Map<wbr/>Node</a></li><li class="tsd-kind-class"><a href="classes/MapNodeGeometry.html" class="tsd-kind-icon">Map<wbr/>Node<wbr/>Geometry</a></li><li class="tsd-kind-class"><a href="classes/MapNodeHeightGeometry.html" class="tsd-kind-icon">Map<wbr/>Node<wbr/>Height<wbr/>Geometry</a></li><li class="tsd-kind-class"><a href="classes/MapPlaneNode.html" class="tsd-kind-icon">Map<wbr/>Plane<wbr/>Node</a></li><li class="tsd-kind-class"><a href="classes/MapProvider.html" class="tsd-kind-icon">Map<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/MapSphereNode.html" class="tsd-kind-icon">Map<wbr/>Sphere<wbr/>Node</a></li><li class="tsd-kind-class"><a href="classes/MapSphereNodeGeometry.html" class="tsd-kind-icon">Map<wbr/>Sphere<wbr/>Node<wbr/>Geometry</a></li><li class="tsd-kind-class"><a href="classes/MapTilerProvider.html" class="tsd-kind-icon">Map<wbr/>Tiler<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/MapView.html" class="tsd-kind-icon">Map<wbr/>View</a></li><li class="tsd-kind-class"><a href="classes/OpenMapTilesProvider.html" class="tsd-kind-icon">Open<wbr/>Map<wbr/>Tiles<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/OpenStreetMapsProvider.html" class="tsd-kind-icon">Open<wbr/>Street<wbr/>Maps<wbr/>Provider</a></li><li class="tsd-kind-class"><a href="classes/UnitsUtils.html" class="tsd-kind-icon">Units<wbr/>Utils</a></li><li class="tsd-kind-class"><a href="classes/XHRUtils.html" class="tsd-kind-icon">XHRUtils</a></li><li class="tsd-kind-interface"><a href="interfaces/LODControl.html" class="tsd-kind-icon">LODControl</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>